<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- jQuery first -->
    <script src="js/jquery-3.6.3.min.js"></script>
    <!-- Bootstrap CSS and JS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <!-- AOS Animation Library -->
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <!-- Favicon sederhana -->
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />

    <title>Ambil Antrian - Melati Gold Shop</title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/pages/style-ambil.css" />
  </head>
  <body>
    <!-- Decorative Elements -->
    <div class="gold-decoration top-left"></div>
    <div class="gold-decoration bottom-right"></div>

    <!-- Header -->
    <header class="header">
      <div class="container">
        <div class="row align-items-center justify-content-beetween">
          <div class="col-md-6">
            <div class="logo-container">
              <img src="img/Melati.jfif" alt="Logo" class="logo gold-shimmer" />
              <h1 class="brand-name"><a href="admin.html" class="text-decoration-none">Melati Gold Shop</a></h1>
            </div>
          </div>
          <div class="col-md-6">
            <div class="date-time">
              <div class="current-date" id="current-date"></div>
              <div class="current-time" id="current-time"></div>
              <!-- Edit Price Button -->
              <button class="edit-price-btn" id="editPriceBtn" title="Edit Harga Emas">
                <i class="fas fa-cog"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="container">
      <!-- Page Title -->
      <div class="page-title" data-aos="fade-up" data-aos-delay="100">
        <h1>AMBIL NOMOR ANTRIAN</h1>
      </div>

      <!-- Three Column Layout -->
      <div class="row g-4">
        <!-- Petunjuk Penggunaan -->
        <div class="col-lg-4" data-aos="fade-up" data-aos-delay="200">
          <div class="queue-card gold-border">
            <div class="queue-card-header">
              <h2>
                <i class="fas fa-info-circle"></i>
                PETUNJUK PENGGUNAAN
              </h2>
            </div>
            <div class="queue-card-body instructions-body">
              <ol class="instruction-list">
                <li>Klik tombol "Ambil Antrian" untuk mendapatkan nomor antrian</li>
                <li>Struk antrian akan dicetak otomatis</li>
                <li>Simpan struk sebagai bukti nomor antrian Anda</li>
                <li>Tunggu nomor Anda dipanggil pada layar display</li>
              </ol>
            </div>
          </div>
        </div>

        <!-- Nomor Antrian Anda -->
        <div class="col-lg-4" data-aos="fade-up" data-aos-delay="300">
          <div class="queue-card card-current gold-border">
            <div class="queue-card-header">
              <h2>
                <i class="fas fa-ticket-alt"></i>
                NOMOR ANTRIAN ANDA
              </h2>
            </div>
            <div class="queue-card-body">
              <div class="queue-number active" id="nextQueueNumber">
                A
                <span id="queueValue">001</span>
              </div>

              <!-- Take Queue Button -->
              <div class="button-container">
                <button type="button" class="btn-take-queue mt-4" id="takeQueueBtn">
                  <i class="fas fa-hand-pointer me-2"></i>
                  Ambil Antrian
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Informasi -->
        <div class="col-lg-4" data-aos="fade-up" data-aos-delay="400">
          <div class="queue-card gold-border">
            <div class="queue-card-header">
              <h2>
                <i class="fas fa-chart-line"></i>
                INFORMASI
              </h2>
            </div>
            <div class="queue-card-body info-body">
              <div class="info-section mb-2">
                <h5 class="info-title">
                  <i class="fas fa-clock text-warning"></i>
                  Operational Hours
                </h5>
                <p class="info-text">Senin - Minggu : 09:00 - 21:00</p>
              </div>

              <div class="elegant-divider-small my-3"></div>

              <div class="info-section">
                <h5 class="info-title">
                  <i class="fas fa-coins text-warning"></i>
                  Harga Emas Hari Ini
                </h5>
                <div class="gold-prices" id="goldPrices">
                  <div class="price-item">
                    <span class="karat">8K</span>
                    <span class="price" id="price8k">Rp 875.000</span>
                  </div>
                  <div class="price-item">
                    <span class="karat">9K</span>
                    <span class="price" id="price9k">Rp 975.000</span>
                  </div>
                  <div class="price-item">
                    <span class="karat">16K</span>
                    <span class="price" id="price16k">Rp 1.425.000</span>
                  </div>
                  <div class="price-item">
                    <span class="karat">17K</span>
                    <span class="price" id="price17k">Rp 1.550.000</span>
                  </div>
                  <div class="price-item">
                    <span class="karat">18K</span>
                    <span class="price" id="price18k">Rp 1.600.000</span>
                  </div>
                </div>
                <small class="price-note">Per gram</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Success Modal -->
    <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body text-center">
            <div class="success-animation">
              <i class="fas fa-check-circle success-icon"></i>
            </div>
            <h4 class="success-title">Antrian Berhasil Diambil!</h4>
            <p class="success-message">
              Mohon ditunggu dan selamat berbelanja
              <br />
              <strong>
                Nomor Antrian Anda:
                <span id="modalQueueNumber"></span>
              </strong>
            </p>
            <div class="print-status mt-3">
              <div class="spinner-border spinner-border-sm me-2" role="status" id="printSpinner">
                <span class="visually-hidden">Mencetak...</span>
              </div>
              <span id="printStatus">Mencetak struk antrian...</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Print Receipt Template (Hidden) -->
    <div id="receiptTemplate" class="d-none">
      <div class="receipt-container">
        <div class="receipt-header">
          <h3>MELATI GOLD SHOP</h3>
          <p>================================</p>
        </div>
        <div class="receipt-body">
          <div class="receipt-row">
            <span>NOMOR ANTRIAN</span>
          </div>
          <div class="receipt-number" id="receiptNumber">A001</div>
          <p>================================</p>
          <div class="receipt-info">
            <div class="receipt-row">
              <span>
                Tanggal:
                <span id="receiptDate"></span>
              </span>
            </div>
            <div class="receipt-row">
              <span>
                Waktu:
                <span id="receiptTime"></span>
              </span>
            </div>
          </div>
          <p>================================</p>
          <div class="receipt-footer">
            <p>TERIMA KASIH</p>
            <p>Mohon simpan struk ini sebagai</p>
            <p>bukti nomor antrian Anda</p>
            <p>Selamat berbelanja!</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Price Modal - Add before closing body tag -->
    <div class="modal fade" id="editPriceModal" tabindex="-1" aria-labelledby="editPriceModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editPriceModalLabel">
              <i class="fas fa-coins me-2"></i>
              Edit Harga Emas Per Gram
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editPriceForm">
              <div class="row g-3">
                <div class="col-md-6">
                  <label for="price8k" class="form-label">8K (per gram)</label>
                  <div class="input-group">
                    <span class="input-group-text">Rp</span>
                    <input type="number" class="form-control" id="editPrice8k" required />
                  </div>
                </div>
                <div class="col-md-6">
                  <label for="price9k" class="form-label">9K (per gram)</label>
                  <div class="input-group">
                    <span class="input-group-text">Rp</span>
                    <input type="number" class="form-control" id="editPrice9k" required />
                  </div>
                </div>
                <div class="col-md-6">
                  <label for="price16k" class="form-label">16K (per gram)</label>
                  <div class="input-group">
                    <span class="input-group-text">Rp</span>
                    <input type="number" class="form-control" id="editPrice16k" required />
                  </div>
                </div>
                <div class="col-md-6">
                  <label for="price17k" class="form-label">17K (per gram)</label>
                  <div class="input-group">
                    <span class="input-group-text">Rp</span>
                    <input type="number" class="form-control" id="editPrice17k" required />
                  </div>
                </div>
                <div class="col-md-6">
                  <label for="price18k" class="form-label">18K (per gram)</label>
                  <div class="input-group">
                    <span class="input-group-text">Rp</span>
                    <input type="number" class="form-control" id="editPrice18k" required />
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
            <button type="button" class="btn btn-primary" id="savePricesBtn">
              <i class="fas fa-save me-2"></i>
              Simpan Harga
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="social-links">
          <a href="#"><i class="fab fa-instagram"></i></a>
          <a href="#"><i class="fab fa-facebook"></i></a>
          <a href="#"><i class="fab fa-whatsapp"></i></a>
        </div>
        <p>&copy; 2025 Melati Gold Shop. All rights reserved.</p>
      </div>
    </footer>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>

    <!-- Update bagian script loading di akhir body -->
    <!-- jQuery first -->
    <script src="js/jquery-3.6.3.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>

    <!-- AOS Animation Library -->
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

    <!-- Custom JavaScript as Module -->
    <script type="module" src="js/ambil-antrian.js"></script>

    <script>
      // Initialize AOS animation
      AOS.init({ duration: 800, once: false });

      // Update DateTime
      function updateDateTime() {
        const now = new Date();
        const dateElement = document.getElementById("current-date");
        const timeElement = document.getElementById("current-time");
        const currentDateElement = document.getElementById("currentDate");

        if (dateElement) {
          dateElement.textContent = now.toLocaleDateString("id-ID", {
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
          });
        }
        if (timeElement) {
          timeElement.textContent = now.toLocaleTimeString("id-ID");
        }
        if (currentDateElement) {
          currentDateElement.textContent = now.toLocaleDateString("id-ID", {
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
          });
        }
      }
      updateDateTime();
      setInterval(updateDateTime, 1000);
    </script>
  </body>
</html>
